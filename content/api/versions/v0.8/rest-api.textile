---
title: REST API Specification
section: api
index: 100
jump_to:
  Channel API:
    - publish
    - message history#message-history
    - presence
    - presence history
  Authentication API:
    - requestToken#request-token
  Application API:
    - stats
  Utilities API:
    - time
---

h2(#channel). Channel routes

Routes providing access to the messaging service within a channel scope.

h3(#publish). Publish one or more messages on a channel

h6. POST rest.ably.io/channels/@<channelId>@/messages

Publish a message on a channel. Note that since the REST API is stateless, publication using this API is outside the context of any specific connection.

The request body contains message details and is an object of the form:

bc[json]. {
  name: <event name>,
  data: <message payload>,
  encoding: <optional encoding>,
  clientId: <optional explicit client identifier>,
  connectionKey: <optional private connection key>
}

In JSON format, the accepted types for the @data@ payload are:

* string
* any JSON-encodable Array or Object.

MessagePack additionally "supports byte arrays":https://github.com/msgpack/msgpack/blob/master/spec.md#formats-bin

A message may be published over REST on behalf of an existing realtime connection when a valid @connectionKey@ is present. For example, if you want to publish a message using the REST API so that it appears to come from an existing connected realtime client, then the connection's "private (secret) connection key":/api/realtime-sdk/connection#key must be included. See a "publish on behalf of a realtime client example":<%= JsBins.url_for('rest/publish-on-behalf-of-client') %>.

Example request:

bc[sh]. curl -X POST https://rest.ably.io/channels/rest-example/messages \
 -u "{{API_KEY}}" \
 -H "Content-Type: application/json" \
 --data '{ "name": "publish", "data": "example" }'

h5. Parameters

None

h5. Options

- Content-Type := @application/json@, @application/x-msgpack@ or @application/x-www-form-urlencoded@
- Accept := not applicable
- Auth required := yes ("basic":#basic-authentication or "token":#token-authentication)

h5. Returns

Nothing when successful, else returns an error.

h3(#message-history). Retrieve message history for a channel

h6. GET rest.ably.io/channels/@<channelId>@/messages

If a channel is "configured to persist messages":/general/channel-rules-namespaces, then all messages on that channel, within "your account retention period":https://faqs.ably.com/how-long-are-messages-stored-for, are available via this API endpoint.  If persistence is not configured, then there are no guarantees as to how many historical messages will be available for the channel.  "Find out more about message persistence":https://faqs.ably.com/how-long-are-messages-stored-for.

Example request:

bc[sh]. curl https://rest.ably.io/channels/rest-example/messages \
 -u "{{API_KEY}}"

h5. Parameters

- start := _beginning of time_ The start of the query interval as a time in milliseconds since the epoch. A message qualifies as a member of the result set if it was received at or after this time.
- end := _now_ The end of the query interval as a time in milliseconds since the epoch. A message qualifies as a member of the result set if it was received at or before this time.
- limit := _100_ The maximum number of records to return. A limit greater than 1,000 is invalid.
- direction := _backwards_ The direction of this query. The direction determines the order of the returned result array, but also determines which end of the query interval is the start point for the search.  For example, a forwards query uses @start@ as the start point, whereas a backwards query uses @end@ as the start point.

h5. Options

- Content-Type := not applicable
- Accept := @application/json@ by default, or @application/x-msgpack@, @text/html@
- Auth required := yes ("basic":#basic-authentication or "token":#token-authentication)

h5. Returns

In each case a successful result is a "paginated response":#pagination with an array containing the items that match the query (and it may be empty).

bc[json]. [{
  id: <unique message id>
  name: <event name>,
  data: <message payload>,
  timestamp: <message timestamp in ms since epoch>
}]

h3(#presence). Retrieve instantaneous presence status for a channel

h6. GET rest.ably.io/channels/@<channelId>@/presence

Obtain the set of members currently present for a channel.

Example request:

bc[sh]. curl https://rest.ably.io/channels/rest-example/presence \
 -u "{{API_KEY}}"

h5. Parameters

- clientId := optional filter to restrict members present with that @clientId@
- connectionId := optional filter to restrict members present with that @connectionId@
- limit := _100_ The maximum number of records to return. A limit greater than 1,000 is invalid.

h5. Options

- Content-Type := not applicable
- Accept := @application/json@ by default, or @application/x-msgpack@, @text/html@
- Auth required := yes ("basic":#basic-authentication or "token":#token-authentication)

h5. Returns

A successful request returns a "paginated response":#pagination with an array containing the members that are currently present on the given channel. If there are no members present, an empty collection is returned.

bc[json]. [{
  id: <a unique member identifer generated by Ably>,
  clientId: <member client id provided by the client>,
  connectionId: <a unique connection id generated by Ably>
  timestamp: <message timestamp in ms since epoch>
  action: <presence state>,
  data: <optional clientData provided by the client>
}]

h3(#presence-history). Retrieve presence state history for a channel

h6. GET rest.ably.io/channels/@<channelId>@/presence/history

Obtain the history of presence messages for a channel.

Example request:

bc[sh]. curl https://rest.ably.io/channels/rest-example/presence/history \
 -u "{{API_KEY}}"

h5. Parameters

- start := _beginning of time_ The start of the query interval as a time in milliseconds since the epoch. A message qualifies as a member of the result set if it was received at or after this time.
- end := _now_ The end of the query interval as a time in milliseconds since the epoch. A message qualifies as a member of the result set if it was received at or before this time.
- limit := _100_ The maximum number of records to return. A limit greater than 1,000 is invalid.
- direction := _backwards_ The direction of this query. The direction determines the order of the returned result array, but also determines which end of the query interval is the start point for the search.  For example, a forwards query uses @start@ as the start point, whereas a backwards query uses @end@ as the start point.

h5. Options

- Content-Type := not applicable
- Accept := @application/json@ by default, or @application/x-msgpack@, @text/html@
- Auth required := yes ("basic":#basic-authentication or "token":#token-authentication)

h5. Returns

A successful request returns a "paginated response":#pagination with an array containing the members that are currently present on the given channel. If there are no members present, an empty collection is returned.

bc[json]. [{
  id: <a unique member identifer generated by Ably>,
  clientId: <member client id provided by the client>,
  connectionId: <a unique connection id generated by Ably>
  timestamp: <message timestamp in ms since epoch>
  action: <presence state>,
  data: <optional clientData provided by the client>
}]

h2. Authentication

h3(#request-token). Request an access token

<!-- TODO: Review the suitability of the documentation that describes the token request and the token body response and provide suitable links -->

h6. POST rest.ably.io/keys/@<keyName>@/requestToken

This is the means by which clients obtain access tokens to use the service. The construction of a token request is described in the "Authentication token request spec documentation":/core-features/authentication#token-request-spec. The resulting @token response@ object contains the token properties as defined in "token request spec":/core-features/authentication#token-request-spec.

Example request:

bc[sh]. curl -X POST "https://rest.ably.io/keys/{{API_KEY_NAME}}/requestToken" \
 -u "{{API_KEY}}" \
 -H "Content-Type: application/json" \
 --data '{ "keyName": "{{API_KEY_NAME}}", "timestamp": {{MS_SINCE_EPOCH}} }'

h5. Parameters

None

h5. Options

- Request body := signed or unsigned token request. All token requests require values for @keyName@ and @timestamp@ attributes. In addition, signed token require values for attributes @nonce@ and @mac@.
- Content-Type := @text/plain@
- Accept := @application/json@ by default, or @application/x-msgpack@
- Auth required := no (for signed token requests), yes (for unsigned token requests, "basic":#basic-authentication or "token":#token-authentication permitted)

h5. Returns

A successful request will return a "token details object":/api/realtime-sdk/types#token-details containing the token string.

bc[json]. {
  "token": "xVLyHw.CLchevH3hF....MDh9ZC_Q", // token string
  "keyName": "xVLyHw.mDYnFA",
  "issued": 1428356667,
  "expires": 1428360267,
  "capability": "{\"*\":[\"*\"]}"
}

h2(#application). Application routes

Routes providing access to the messaging service within an application scope.

h3(#stats). Retrieve usage statistics for an application

h6. GET rest.ably.io/stats

Example request:

bc[sh]. curl https://rest.ably.io/stats?unit=hour \
 -u "{{API_KEY}}"

The Ably system can be queried to obtain usage statistics for a given application, and results are provided aggregated across all channels in use in the application in the specified period. Stats may be used to track usage against account quotas.

Stats queries are made by specifying a query interval and the granularity expected in the results. The query interval is expressed as a start and end time, each being a timestamp in milliseconds since the epoch. Stats are aggregated by the system in 'sub-minute' intervals of 6s (ie 0.1m), so query interval start and end times are rounded down to the nearest sub-minute boundary.

h5. Parameters

- start := _beginning of time_ The start of the query interval as a time in milliseconds since the epoch.
- end := _now_ The end of the query interval as a time in milliseconds since the epoch.
- limit := _100_ The maximum number of records to return. A limit greater than 1,000 is invalid.
- direction := _backwards_ The direction of this query. The direction determines the order of the returned result array, but also determines which end of the query interval is the start point for the search.
- unit := _@minute@_ One of the values @minute@, @hour@, @day@ or @month@, specifying the unit of aggregation in the returned results.

h5. Options

- Content-Type := not applicable
- Accept := @application/json@ by default, or @application/x-msgpack@, @text/html@
- Auth required := yes ("basic":#basic-authentication or "token":#token-authentication)

h5. Returns

In each case a successful result is a "paginated response":#pagination with an array containing the items that match the query (and it may be empty).

Stats records contain a hierarchy of elements relating to messages, connections and other resources consumed in an interval. Any single record may contain a subset of the elements, omitting empty sections.

"See a complete example of a statistics response":/general/statistics.

h2(#utilities). Utilities

h3(#time). Get the service time

h6. GET rest.ably.io/time

This returns the service time in milliseconds since the epoch. This may be used by clients that do not have local access to a sufficiently accurate time source when generating a token request. (Token requests include a timestamp and have a limited validity period to help defend against replay attacks.)

The result is a JSON-encoded array of length 1 containing the time result as a number.

bc[sh]. curl http://rest.ably.io/time

h5. Parameters

None

h5. Options

- Content-Type := not applicable
- Accept := @application/json@ by default, or @application/x-msgpack@, @text/html@
- Auth required := no

h5. Returns

bc[json]. [ {{MS_SINCE_EPOCH}} ]
